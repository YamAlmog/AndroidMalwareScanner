import pandas as pd

class FileVectorCreator():
    def __init__(self, csv_path:str, permissions:list) -> None:
        self.csv_file = csv_path
        self.permissions = permissions

    def create_vector(self):
        android_df = pd.read_csv(self.csv_file)
        android_df = android_df.drop('Unnamed: 0', axis=1)
        android_df = android_df.drop('label',axis=1)

        features = android_df.columns.tolist()
        # Create a DataFrame with zeros
        file_vector = pd.DataFrame(0, index=[0], columns=features)

        # Get only valid permissions that are present in features
        valid_permissions = list(set(self.permissions) & set(features))
        # Set values to 1 for features present in permissions
        file_vector.loc[:, valid_permissions] = 1
         
        return file_vector
    
