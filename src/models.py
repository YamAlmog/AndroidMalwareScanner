from pydantic import BaseModel
from typing import Optional
from typing import List
from enum import Enum

from classifier import Verdict


class Metadata(BaseModel):
    file_hash: str
    permissions: str

class OtherProvidersClassifications(BaseModel):
    VirusTotal: Verdict
    MalwareBazaar: Optional[Verdict] = None
    Kaspersky: Optional[Verdict] = None

class ClassificationResponse(BaseModel):
    verdict: Verdict 
    probability: float
    metadata: Optional[Metadata] = None
    other_providers: Optional[OtherProvidersClassifications] = None
    in_cache: Optional[bool] = False